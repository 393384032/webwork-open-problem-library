##DESCRIPTION
##  Using a GeoGebra applet to provide an interactive accumulation function
##ENDDESCRIPTION


## DBsubject(Calculus - single variable)
## DBchapter(Integrals)
## DBsection(Fundamental theorem of calculus)
## Date(05/21/2015)
## Institution(Hope College)
## Author(Paul Pearson)
## MLT(FTC_07)
## Level(3)
## MO(1)
## KEYWORDS('GeoGebra applet example','Accumulation function','Fundamental Theorem of Calculus')

##########################################
#  Initialization

DOCUMENT();

loadMacros(
"PGstandard.pl",
"MathObjects.pl",
"unionTables.pl",
"AppletObjects.pl",
#"parserNumberWithUnits.pl",
"PGchoicemacros.pl",
"PGcourse.pl",
);
 
$showPartialCorrectAnswers = 1;

TEXT(beginproblem());


##########################################
#  Setup

Context("Interval");

$mc = new_multiple_choice();
$mc->qa(
"Why is \( F(x) \) positive when \( x \) is negative?", 
"Because \( f(x) \) is negative and integrating right-to-left is negative",
);
$mc->extra(
"Because integrating right-to-left is negative",
"Because integrals are always positive",
"Because accumulation functions like \( F(x) \) are always positive",
);
$mc->makeLast("None of the above");


######################################
# Create  link to applet:
###################################
# You can name your applet (anything reasonable :-) )
# Adjust the height and width as desired
# Paste the geogebra parameters in at the bottom of the page just above the
# command end command
# so that they don't get in the way
###################################


$appletName = "ggbAF1";

$applet =  GeogebraWebApplet(
   code       => "geogebra.GeoGebraApplet",
   archive    => "geogebra.jar",
   codebase                 => findAppletCodebase("geogebra.jar"),
   appletName              => $appletName,
   appletId                    => $appletName,
   submitActionAlias     => 'getAppletValues',  # default actionAlias
   initializeActionAlias   => 'configure',  # default actionAlias
   setStateAlias             => 'setXML',
   getStateAlias             => 'getXML',
   setConfigAlias           => '',
   getConfigAlias           => '',
   returnFieldName       => '',
   width                 => 507,              # may want to modify width
   height                => 394,              # may want to modify height
  # mayscript             => "true",
   debugMode             => 0,   # set debugMode to 0 for no debug
                                              # to 1 to make xml representation visible
                                              # to 2 to add alerts detailing progression
                                              # through the applet
   onInit                => 'ggbOnInit',
   type                  => 'geogebraweb',
   #submitActionScript    => qq{ getQE('answerBox').value = getAppletValues() },
   submitActionScript => '',
   selfLoading           => 1,
   params     => GEOGEBRA_PARAMS(),# paste parameters in

);


##################################
# Setup GeogebraWebApplet --
###################################

###############################################
#
#  For persistence of GeoGebra applet state 
#  when answers are submitted or page is refreshed.
#  Uses JavaScript interface to GeoGebra.

HEADER_TEXT(
qq! 
<script language="javascript">
   function ggbOnInit(param) {
       if (param == "$appletName") {
           applet_loaded(param,1);  // report that applet is ready. 
           ww_applet_list[param].safe_applet_initialize(2);
       }
   } 
</script>
<noscript>For this question to work properly, 
you must enable JavaScript, or use another browser 
(or computer) on which JavaScript works.</noscript>
!);




####################
#  PNG picture of GeoGebra applet for hardcopy

$im = image( "AF1.png", width=>520, height=>278, tex_size=>900 );




##########################################
#  Main text

Context()->texStrings;
BEGIN_TEXT
\{
ColumnTable(
"The figure shows an interactive graph of \( y = f(t) \).  (It may take
a minute to load -- be patient.)  You can 
change the value of \( x \) in the graph by clicking and dragging
the red dot along the horizontal \( t \)-axis.  Assume that the 
lines in each piece of \( f \) continue beyond the graphing window.
Define a function that accumulates signed area between the 
\( t \)-axis and the graph of \( y = f(t) \) by
$PAR
$BCENTER
\( \displaystyle
F(x) = \int_0^x f(t) \, dt
\)
$ECENTER
$BR
$BR
(a) For what values of \( x \) does \( F(x) = 0 \)?
$BR
\( x \approx \) ".
ans_rule(20).
"
$BR 
$BR 
(b) For what values of \( x \) is \( F(x) \geq 0 \)?
$BR
All \( x \) in the interval ".
ans_rule(20).
"
$BR 
$BR 
(c) For what values of \( x \) does \( F(x) = 6 \)?
$BR
\( x \approx \) ".
ans_rule(20).
"
$BR
$BR
(d) ". 
$mc->print_q().
$mc->print_a()
,
$BCENTER.
$BBOLD."Graph of \( y = f(t) \)".$EBOLD.
$PAR.
MODES(HTML=>$applet->insertAll(debug=>0, reinitialize_button=>1, includeAnswerBox=>0,), TeX=>$im).
$ECENTER
,
indent => 0, separation => 30, valign => "TOP"
);
\}
END_TEXT
Context()->normalStrings;



#####################################
#  Answer Evaluation

ANS( List(0,10.9)->cmp(tolerance=>0.101, tolType=>'absolute') );
ANS( Compute("(-inf,10.9)")->cmp(requireParenMatch=>0, tolerance=>0.101, tolType=>'absolute') );
ANS( List(-2.5,2.5,9.5)->cmp(tolerance=>0.101, tolType=>'absolute') );
ANS( radio_cmp( $mc->correct_ans() ) );


#########################################
# The applet as a base64 string
#########################################

sub GEOGEBRA_PARAMS {
    my $result = {
showResetIcon=>"false" ,
enableRightClick=>"false" ,
enableLabelDrags=>"false",
showMenuBar=>"false" ,
showToolBar=>"false",
showAlgebraInput=>"false",
useBrowserForJS=>"true",
ggbbase64=>"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"

};

$result;
}


COMMENT('MathObject version.  Uses GeoGebraWeb (JavaScript) so it should work on computers and tablets.  Not randomized.');

ENDDOCUMENT();
