##DESCRIPTION
##Calculus: Differentiation
##ENDDESCRIPTION

##Tagged by YJ

## DBsubject(Calculus - single variable)
## DBchapter(Differentiation)
## DBsection(Implicit differentiation)
## Date(5/26/2005)
## Institution(UVA)
## Author(Jeff Holt)
## MLT(xy_powers_tangent_m_b)
## Level(3)
## TitleText1('Calculus: Early Transcendentals')
## AuthorText1('Stewart')
## EditionText1('5')
## Section1('3.6')
## Problem1('')
## TitleText2('Calculus: Early Transcendentals')
## AuthorText2('Stewart')
## EditionText2('6')
## Section2('3.5')
## Problem2('')
## KEYWORDS('calculus', 'differentiation')

DOCUMENT();

loadMacros(
	'PGstandard.pl',
	'MathObjects.pl',
	'contextFraction.pl'
);

TEXT(beginproblem());
$showPartialCorrectAnswers = 1;

sub rs {
	my ($n, $d, $r) = @_;
	my $p = 1;
	foreach ( 1 .. int(sqrt($r)) ) {
		$p = $_ if ($r % $_**2 == 0);
	}
	return ( reduce($n * $p, $d), $r / $p**2 )
}

do {
	$a = random(2, 9);
	$a2 = $a**2;
	$b = random(2, 9);
	$b2 = $b**2;
} until (
	$a2 - $b2
);

$s = list_random('+', '-');
$sx = list_random('', '-');
$sy = list_random('', '-');
$sm = ( $sx eq $sy
	? ( $s eq '+' ? '-' : '' )
	: ( $s eq '+' ? '' : '-' )
);
($iarticle, $curve) = ( $s eq '+'
	? ('an', 'ellipse')
	: ('a', 'hyperbola')
);
$axo = ( $s eq '+'
	? non_zero_random(1, $a - 1)
	: non_zero_random($a + 1, 2 * $a)
);
$xo = $sx . $axo;

Context('Fraction');
($ayo_n, $ayo_d, $ayo_r) = rs( $b, $a, 
	( $s == '+'
		? $a**2 - $xo**2
		: $xo**2 - $a**2
	)
);
$ayo_rat = Fraction($ayo_n, $ayo_d)->reduce;

($amo_n, $amo_d, $amo_r) = rs(
	$b**2 * $axo * $ayo_d,
	$a**2 * $ayo_n * $ayo_r,
	$ayo_r
);
$amo_rat = Fraction($amo_n, $amo_d)->reduce;

Context('Numeric')->flags->set(
	reduceConstants => 0,
	reduceConstantFunctions => 0
);
$yo = Formula("$sy ($ayo_rat) sqrt($ayo_r)");
$mo = Formula("$sm ($amo_rat) sqrt($amo_r)");

$x1 = random(-3,-1,1);
$x1 = -1;
$y1 = $b*((1 - ($x1**2)/($a**2) )**(1/2));
$m1 = (-1*($b2)*$x1)/(($a2)*$y1);

$num = ($a*$b)**2 - ($x1*$b)**2;

Context()->texStrings;
BEGIN_TEXT
Find the equation of the tangent line to the curve
\[ \frac{x^2}{$a2} $s \frac{y^2}{$b2} = 1 \]
(${iarticle} ${curve}) at the point \( ($xo , $yo) \).
$BR $BR
The equation of this tangent line can be written in the form \( y = mx+b \)
where \( m \) is: \{ans_rule(30) \}
and  where \( b \) is: \{ans_rule(30) \}
END_TEXT
Context()->normalStrings;

$ans = $m1;
ANS(num_cmp($ans));

$ans = $y1 -$m1*$x1;
ANS(num_cmp($ans));

ENDDOCUMENT();
